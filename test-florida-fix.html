<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Florida Game Date - Manual</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        h1 { color: #bf5700; }
        .test-section { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 5px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { 
            background: #bf5700; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px;
        }
        button:hover { background: #a04600; }
        pre { background: #333; color: #0f0; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèà Test Florida Game Date Fix</h1>
        
        <div class="test-section">
            <h2>1. Manual Test Links</h2>
            <button onclick="window.open('http://localhost:5173/games', '_blank')">Open Local Games Page</button>
            <button onclick="window.open('https://texas-tailgaters.onrender.com/games', '_blank')">Open Production Games Page</button>
            <p class="info">Login with: test@texastailgaters.com / TestPassword123!</p>
            <p>Check if Florida game shows <strong>Oct 4</strong> (not Oct 3)</p>
        </div>

        <div class="test-section">
            <h2>2. Check Firebase Database</h2>
            <button onclick="checkFirebase()">Check Florida Game in Database</button>
            <div id="firebase-result"></div>
        </div>

        <div class="test-section">
            <h2>3. Test Date Parsing</h2>
            <button onclick="testDateParsing()">Test Date Parsing</button>
            <div id="date-result"></div>
        </div>

        <div class="test-section">
            <h2>4. Fetch Games via API</h2>
            <button onclick="fetchGames()">Fetch All Games</button>
            <div id="games-result"></div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, get } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        import { getAuth, signInWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBJascYs4rXD4uL5Z8F7RDkMOBhQtjehic",
            authDomain: "texas-tailgaters.firebaseapp.com",
            databaseURL: "https://texas-tailgaters-default-rtdb.firebaseio.com",
            projectId: "texas-tailgaters",
            storageBucket: "texas-tailgaters.appspot.com",
            messagingSenderId: "517392756353",
            appId: "1:517392756353:web:texas-tailgaters-web"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const auth = getAuth(app);

        window.checkFirebase = async function() {
            const resultDiv = document.getElementById('firebase-result');
            resultDiv.innerHTML = '<div class="status info">Checking database...</div>';
            
            try {
                const gamesRef = ref(database, 'games');
                const snapshot = await get(gamesRef);
                
                if (snapshot.exists()) {
                    const games = snapshot.val();
                    let floridaGame = null;
                    let octoberGames = [];
                    
                    Object.entries(games).forEach(([id, game]) => {
                        if (game.opponent === 'Florida') {
                            floridaGame = { id, ...game };
                        }
                        if (game.date && game.date.startsWith('2025-10')) {
                            octoberGames.push({ id, ...game });
                        }
                    });
                    
                    let html = '';
                    if (floridaGame) {
                        const isCorrect = floridaGame.date === '2025-10-04';
                        html += `<div class="status ${isCorrect ? 'success' : 'error'}">
                            Florida Game: ${floridaGame.date} - ${isCorrect ? '‚úÖ CORRECT (Oct 4)' : '‚ùå WRONG (should be Oct 4)'}
                        </div>`;
                        html += '<pre>' + JSON.stringify(floridaGame, null, 2) + '</pre>';
                    } else {
                        html += '<div class="status error">‚ùå Florida game not found in database</div>';
                    }
                    
                    html += '<h3>All October 2025 Games:</h3>';
                    octoberGames.sort((a, b) => a.date.localeCompare(b.date));
                    octoberGames.forEach(game => {
                        html += `<div class="status info">${game.date} - ${game.opponent}</div>`;
                    });
                    
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = '<div class="status error">No games in database</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="status error">Error: ' + error.message + '</div>';
            }
        };

        window.testDateParsing = function() {
            const resultDiv = document.getElementById('date-result');
            const testDate = '2025-10-04';
            
            // How dates are parsed incorrectly (UTC midnight)
            const wrongWay = new Date(testDate);
            
            // How they should be parsed (with noon time)
            const rightWay = new Date(testDate + 'T12:00:00');
            
            // Helper function that should be used
            function parseGameDate(dateString) {
                // Add noon time to prevent timezone issues
                return new Date(dateString + 'T12:00:00');
            }
            
            const correctlyParsed = parseGameDate(testDate);
            
            const html = `
                <h3>Date Parsing Test for: ${testDate}</h3>
                <div class="status error">
                    ‚ùå Wrong (UTC midnight): ${wrongWay.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                    <br>Full: ${wrongWay.toString()}
                </div>
                <div class="status success">
                    ‚úÖ Correct (noon time): ${rightWay.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                    <br>Full: ${rightWay.toString()}
                </div>
                <div class="status success">
                    ‚úÖ Using parseGameDate(): ${correctlyParsed.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                    <br>Full: ${correctlyParsed.toString()}
                </div>
            `;
            
            resultDiv.innerHTML = html;
        };

        window.fetchGames = async function() {
            const resultDiv = document.getElementById('games-result');
            resultDiv.innerHTML = '<div class="status info">Fetching games...</div>';
            
            try {
                // First, authenticate
                await signInWithEmailAndPassword(auth, 'test@texastailgaters.com', 'TestPassword123!');
                
                const gamesRef = ref(database, 'games');
                const snapshot = await get(gamesRef);
                
                if (snapshot.exists()) {
                    const games = Object.entries(snapshot.val())
                        .map(([id, game]) => ({ id, ...game }))
                        .filter(game => game.date && game.date.startsWith('2025'))
                        .sort((a, b) => a.date.localeCompare(b.date));
                    
                    let html = '<h3>All 2025 Games:</h3>';
                    games.forEach(game => {
                        const date = new Date(game.date + 'T12:00:00');
                        const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                        const isFloridaGame = game.opponent === 'Florida';
                        
                        html += `<div class="status ${isFloridaGame ? 'success' : 'info'}">
                            ${isFloridaGame ? '‚≠ê ' : ''}${dateStr} - ${game.opponent} 
                            ${game.isHome ? '(Home)' : '(Away)'}
                            ${isFloridaGame ? ' - CHECK THIS DATE!' : ''}
                        </div>`;
                    });
                    
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = '<div class="status error">No games found</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="status error">Error: ' + error.message + '</div>';
            }
        };
    </script>
</body>
</html>
