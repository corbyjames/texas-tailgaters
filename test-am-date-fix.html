<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A&M Game Date Test</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; max-width: 1000px; margin: 40px auto; padding: 20px; background: #f5f5f5; }
        .test-section { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        h1 { color: #ea580c; }
        .result { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .pass { background: #ecfdf5; border-left: 4px solid #10b981; }
        .fail { background: #fef2f2; border-left: 4px solid #ef4444; }
        .info { background: #f0f9ff; border-left: 4px solid #3b82f6; }
        button { background: #ea580c; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; margin: 8px; font-weight: 600; }
        button:hover { background: #c2410c; }
        iframe { width: 100%; height: 600px; border: 1px solid #ddd; border-radius: 8px; }
        .test-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .manual-check { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; }
        pre { background: #f3f4f6; padding: 10px; border-radius: 4px; overflow-x: auto; font-size: 12px; }
    </style>
</head>
<body>
    <h1>üß™ A&M Game Date Testing Suite</h1>

    <div class="test-section">
        <h2>Automated Date Logic Test</h2>
        <button onclick="runDateLogicTest()">üî¨ Run Date Logic Test</button>
        <div id="dateLogicResults"></div>
    </div>

    <div class="test-section">
        <h2>Live Application Tests</h2>
        <div class="test-grid">
            <div>
                <h3>Local Development</h3>
                <button onclick="testLocal()">üè† Test Local (localhost:5173)</button>
                <div id="localResults"></div>
            </div>
            <div>
                <h3>Production</h3>
                <button onclick="testProduction()">üåê Test Production</button>
                <div id="productionResults"></div>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>Manual Verification</h2>
        <div class="manual-check">
            <h3>‚úÖ Steps to Manually Verify</h3>
            <ol>
                <li><strong>Open Games Page:</strong> Navigate to games page in both local and production</li>
                <li><strong>Find A&M Game:</strong> Look for "Texas vs A&M" or "vs A&M" or "@ A&M"</li>
                <li><strong>Check Date:</strong> Verify it shows "Saturday, November 30" NOT "Friday, November 29"</li>
                <li><strong>Check Consistency:</strong> Date should be same in both collapsed and expanded views</li>
                <li><strong>Check Header:</strong> GameHeader component should also show Saturday</li>
            </ol>
        </div>
        <div class="test-grid">
            <button onclick="window.open('http://localhost:5173/games', '_blank')">üè† Open Local Games Page</button>
            <button onclick="window.open('https://texas-tailgaters.onrender.com/games', '_blank')">üåê Open Production Games Page</button>
        </div>
    </div>

    <div class="test-section">
        <h2>Embedded Local Test</h2>
        <p>This iframe shows your local development server:</p>
        <iframe id="localFrame" src="http://localhost:5173/games" title="Local Games Page"></iframe>
        <button onclick="refreshFrame()">üîÑ Refresh Frame</button>
        <button onclick="document.getElementById('localFrame').src='http://localhost:5173/games'">üéØ Navigate to Games Page</button>
    </div>

    <script>
        function runDateLogicTest() {
            const resultsDiv = document.getElementById('dateLogicResults');
            
            try {
                const createLocalDate = (dateString) => new Date(dateString + 'T12:00:00');
                const parseGameDate = (dateString) => { const date = new Date(dateString + 'T12:00:00'); date.setHours(0, 0, 0, 0); return date; };

                const amDate = '2024-11-30';
                const fixedResult = createLocalDate(amDate);
                const oldResult = parseGameDate(amDate);
                
                const fixedDay = fixedResult.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
                const oldDay = oldResult.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
                
                const fixedCorrect = fixedDay.includes('Saturday');
                const oldCorrect = oldDay.includes('Saturday');
                const currentTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                
                resultsDiv.innerHTML = \`
                    <div class="info">
                        <h3>üïê Test Environment</h3>
                        <p><strong>Current Timezone:</strong> \${currentTimezone}</p>
                        <p><strong>Test Date:</strong> \${amDate} (Expected: Saturday, November 30, 2024)</p>
                        <p><strong>Local Time:</strong> \${new Date().toString()}</p>
                    </div>
                    <div class="result \${fixedCorrect ? 'pass' : 'fail'}">
                        <h3>‚úÖ Fixed Method (createLocalDate - Now in Production)</h3>
                        <p><strong>Method:</strong> new Date(dateString + 'T12:00:00') - keeps at noon</p>
                        <p><strong>Result:</strong> \${fixedDay}</p>
                        <p><strong>Status:</strong> \${fixedCorrect ? '‚úÖ PASS - Shows Saturday!' : '‚ùå FAIL - Wrong day'}</p>
                        <pre>ISO String: \${fixedResult.toISOString()}</pre>
                    </div>
                    <div class="result \${oldCorrect ? 'pass' : 'fail'}">
                        <h3>‚ùå Old Method (parseGameDate - Was causing issues)</h3>
                        <p><strong>Method:</strong> Sets time to 00:00:00 (midnight)</p>
                        <p><strong>Result:</strong> \${oldDay}</p>
                        <p><strong>Status:</strong> \${oldCorrect ? '‚úÖ Would be correct' : '‚ùå Shows wrong day (this was the bug)'}</p>
                        <pre>ISO String: \${oldResult.toISOString()}</pre>
                    </div>
                    <div class="info">
                        <h3>üîß Fix Summary</h3>
                        <p><strong>Problem:</strong> Setting time to midnight can cause timezone shifts</p>
                        <p><strong>Solution:</strong> Keep time at noon (12:00) to avoid date shifts</p>
                        <p><strong>Applied:</strong> Updated GameCard.tsx to use createLocalDate instead of parseGameDate</p>
                        <p><strong>Result:</strong> A&M game should now show as Saturday in production</p>
                    </div>
                \`;
                
            } catch (error) {
                resultsDiv.innerHTML = \`<div class="result fail"><h3>‚ùå Test Error</h3><p>Error running date logic test: \${error.message}</p></div>\`;
            }
        }

        function testLocal() {
            document.getElementById('localResults').innerHTML = \`
                <div class="info">
                    <h3>üè† Local Development Test</h3>
                    <p>Testing http://localhost:5173/games</p>
                    <p>‚úÖ Local server should have the date fix applied</p>
                    <p>üîç Look for A&M game showing "Saturday, November 30"</p>
                </div>
                <div class="manual-check">
                    <p><strong>Manual Check:</strong> Use the embedded iframe below or click "Open Local Games Page" to verify</p>
                </div>
            \`;
        }

        function testProduction() {
            document.getElementById('productionResults').innerHTML = \`
                <div class="info">
                    <h3>üåê Production Test</h3>
                    <p>Testing https://texas-tailgaters.onrender.com/games</p>
                    <p>‚úÖ Production deployment should include the date fix</p>
                    <p>üîç Look for A&M game showing "Saturday, November 30"</p>
                </div>
                <div class="manual-check">
                    <p><strong>Manual Check:</strong> Click "Open Production Games Page" to verify the fix is live</p>
                    <p><strong>Note:</strong> May require login to view games</p>
                </div>
            \`;
        }

        function refreshFrame() {
            const frame = document.getElementById('localFrame');
            frame.src = frame.src;
        }

        window.addEventListener('load', () => {
            setTimeout(runDateLogicTest, 100);
        });
    </script>
</body>
</html>